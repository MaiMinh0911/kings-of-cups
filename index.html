<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Kings of Cups â€“ Christmas Casino</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
/* ========== BASE RESET ========== */
* {
  box-sizing: border-box;
}
body {
  margin: 0;
  min-height: 100vh;
  background:
    radial-gradient(circle at center, rgba(255,215,0,0.08), transparent 60%),
    radial-gradient(circle at top, #0e4d3c, #02150f);
  font-family: "Trebuchet MS", system-ui, sans-serif;
  color: #fff;
  text-align: center;
  overflow-x: hidden;
}

/* ========== SETUP SCREEN ========== */
#setup {
  padding: 40px 20px;
}
#setup h1 {
  font-size: 2.5rem;
  margin-bottom: 20px;
}
#player-input {
  padding: 12px;
  font-size: 1.2rem;
  border-radius: 10px;
  border: none;
}
#add-player, #start-game {
  margin: 10px;
  padding: 14px 28px;
  font-size: 1.1rem;
  border-radius: 999px;
  border: none;
  background: gold;
  font-weight: bold;
}
#player-list {
  margin-top: 20px;
  font-size: 1.3rem;
}

/* ========== GAME SCREEN ========== */
#game {
  display: none;
}

/* ========== ACTIVE RULES ========== */
#active-rules {
  position: fixed;
  top: 14px;
  right: 14px;
  text-align: right;
  font-size: 1.1rem;
  line-height: 1.5;
}
.active-rule {
  color: gold;
  animation: pulse 1.4s infinite;
}
@keyframes pulse {
  0%,100% { opacity: 1; }
  50% { opacity: 0.6; }
}

/* ========== TABLE & PLAYERS ========== */
#table {
  position: relative;
  width: 100%;
  max-width: 420px;
  height: 420px;
  margin: 60px auto 20px;
  border-radius: 50%;
  background: radial-gradient(circle, #0b3d2e, #031a13);
  box-shadow: inset 0 0 40px rgba(0,0,0,0.8);
}
.player {
  position: absolute;
  transform: translate(-50%, -50%);
  font-size: 1.2rem;
  padding: 6px 10px;
  border-radius: 12px;
  background: rgba(0,0,0,0.4);
}
.player.active {
  outline: 2px solid gold;
  box-shadow: 0 0 10px gold;
}

/* ========== CARD ========== */
#card {
  position: absolute;
  top: 50%;
  left: 50%;
  width: 160px;
  height: 230px;
  transform: translate(-50%, -50%);
  background: linear-gradient(145deg, #b11226, #7e0b1a);
  border-radius: 18px;
  font-size: 4rem;
  display: flex;
  align-items: center;
  justify-content: center;
  box-shadow: 0 18px 40px rgba(0,0,0,0.7);
  transition: transform 0.6s;
}
#card.flip {
  transform: translate(-50%, -50%) rotateY(180deg);
}

/* ========== RULE TEXT ========== */
#rule-text {
  font-size: 1.4rem;
  padding: 0 20px;
  min-height: 100px;
}

/* ========== BUTTON ========== */
#draw-btn {
  margin: 20px;
  padding: 18px 40px;
  font-size: 1.4rem;
  border-radius: 999px;
  border: none;
  background: linear-gradient(145deg, gold, #c9a300);
  font-weight: bold;
}
</style>
</head>

<body>

<!-- ========== SETUP ========== -->
<div id="setup">
  <h1>ðŸŽ„ Kings of Cups</h1>
  <input id="player-input" placeholder="Player name">
  <br>
  <button id="add-player">Add Player</button>
  <button id="start-game">Start Game</button>
  <div id="player-list"></div>
</div>

<!-- ========== GAME ========== -->
<div id="game">
  <div id="active-rules"></div>

  <div id="table">
    <div id="card">ðŸŽ„</div>
  </div>

  <div id="rule-text">Tap Deal Card</div>
  <button id="draw-btn">Deal Card</button>
</div>

<script>
/* ===== DATA ===== */
const cards = [
  { value: "Ace", rule: "ðŸŽ… Person to your right sings Jingle Bells. You drink until they stop." },
  { value: "2", rule: "ðŸ‘‰ You choose someone to drink" },
  { value: "3", rule: "ðŸº You drink" },
  { value: "4", rule: "ðŸŒ™ Silent Night â€” No talking until NEXT 4", type: "silent" },
  { value: "5", rule: "ðŸ‘¨ Guys drink" },
  { value: "6", rule: "ðŸ‘© Girls drink" },
  { value: "7", rule: "ðŸŽ„ Christmas Spirit â€” Laugh = drink", type: "spirit" },
  { value: "8", rule: "ðŸ¤ Mate â€” Pick a buddy" },
  { value: "9", rule: "ðŸŽ¤ Rhyme" },
  { value: "10", rule: "ðŸ“š Categories" },
  { value: "Jack", rule: "ðŸŽ Naughty or Nice â€” Nice: give 2 | Naughty: drink 2" },
  { value: "Queen", rule: "ðŸŽ… Santaâ€™s Helper â€” Drinks when you drink" },
  { value: "King", rule: "ðŸ¥‚ Santaâ€™s Cup â€” Pour in. Last King drinks + story" }
];

let players = [];
let currentPlayer = 0;
let silentNight = null;
let christmasSpirit = null;

/* ===== SETUP LOGIC ===== */
const playerInput = document.getElementById("player-input");
const playerList = document.getElementById("player-list");

document.getElementById("add-player").onclick = () => {
  if (playerInput.value.trim()) {
    players.push(playerInput.value.trim());
    playerInput.value = "";
    renderPlayerList();
  }
};

document.getElementById("start-game").onclick = () => {
  if (players.length < 2) return alert("Add at least 2 players");
  document.getElementById("setup").style.display = "none";
  document.getElementById("game").style.display = "block";
  renderPlayers();
  renderActiveRules();
};

function renderPlayerList() {
  playerList.innerHTML = players.join("<br>");
}

/* ===== TABLE ===== */
function renderPlayers() {
  const table = document.getElementById("table");
  table.querySelectorAll(".player").forEach(p => p.remove());

  const radius = 170;
  players.forEach((p, i) => {
    const angle = (2 * Math.PI / players.length) * i;
    const x = 210 + radius * Math.cos(angle);
    const y = 210 + radius * Math.sin(angle);

    const el = document.createElement("div");
    el.className = "player" + (i === currentPlayer ? " active" : "");
    el.style.left = x + "px";
    el.style.top = y + "px";
    el.innerText = p;
    table.appendChild(el);
  });
}

/* ===== GAME LOGIC ===== */
document.getElementById("draw-btn").onclick = () => {
  // Christmas Miracle
  if (Math.random() < 1/15) {
    showCard("ðŸŽ", "CHRISTMAS MIRACLE! Last to shout MERRY CHRISTMAS drinks!");
    nextTurn();
    return;
  }

  const card = cards[Math.floor(Math.random() * cards.length)];
  handleSpecial(card);
  showCard(card.value, card.rule);
  renderActiveRules();
  nextTurn();
};

function handleSpecial(card) {
  if (card.type === "silent") silentNight = silentNight === null ? players[currentPlayer] : null;
  if (card.type === "spirit") christmasSpirit = christmasSpirit === null ? players[currentPlayer] : null;
}

function showCard(value, rule) {
  const cardEl = document.getElementById("card");
  cardEl.classList.add("flip");
  setTimeout(() => {
    cardEl.innerText = value;
    document.getElementById("rule-text").innerText = rule;
  }, 300);
  setTimeout(() => cardEl.classList.remove("flip"), 600);
}

function renderActiveRules() {
  const rules = [];
  if (silentNight) rules.push(`ðŸŒ™ Silent Night â€” ${silentNight}`);
  if (christmasSpirit) rules.push(`ðŸŽ„ Christmas Spirit â€” ${christmasSpirit}`);
  document.getElementById("active-rules").innerHTML =
    rules.map(r => `<div class="active-rule">${r}</div>`).join("");
}

function nextTurn() {
  currentPlayer = (currentPlayer + 1) % players.length;
  renderPlayers();
}
</script>

</body>
</html>
