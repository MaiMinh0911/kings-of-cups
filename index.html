<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Kings of Cups â€“ New Yearâ€™s Edition</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
* { box-sizing: border-box; }

body {
  margin: 0;
  min-height: 100vh;
  background:
    radial-gradient(circle at center, rgba(255,215,0,0.10), transparent 60%),
    radial-gradient(circle at top, #1b0036, #05000d);
  font-family: Georgia, serif;
  color: white;
  text-align: center;
}

/* ===== RULE PANEL ===== */
#rules-panel {
  position: fixed;
  left: -260px;
  top: 0;
  width: 260px;
  height: 100%;
  background: linear-gradient(#05000d, #1b0036);
  padding: 60px 20px 20px;
  transition: left 0.4s;
  overflow-y: auto;
  text-align: left;
  z-index: 5;
}
#rules-panel.open { left: 0; }

.rule {
  margin-bottom: 12px;
  font-size: 1rem;
}

/* ===== RULE BUTTON ===== */
#rules-toggle {
  position: fixed;
  left: 10px;
  top: 10px;
  background: gold;
  border: none;
  padding: 10px 16px;
  border-radius: 999px;
  font-weight: bold;
  z-index: 10;
}

/* ===== SETUP ===== */
#setup {
  padding: 40px 20px;
}
#setup h1 { font-size: 2.8rem; }

input {
  font-size: 1.3rem;
  padding: 12px;
  border-radius: 10px;
  border: none;
}

button {
  margin: 12px;
  padding: 16px 36px;
  font-size: 1.3rem;
  border-radius: 999px;
  border: none;
  background: gold;
  font-weight: bold;
}

/* ===== GAME ===== */
#game { display: none; }

/* ===== ACTIVE RULES ===== */
#active-rules {
  position: fixed;
  top: 14px;
  right: 14px;
  font-size: 1.15rem;
  text-align: right;
}
.active-rule {
  color: gold;
  animation: pulse 1.5s infinite;
}
@keyframes pulse { 50% { opacity: 0.6; } }

/* ===== TABLE ===== */
#table {
  position: relative;
  width: 420px;
  height: 420px;
  margin: 60px auto 20px;
  border-radius: 50%;
  background: radial-gradient(circle, #2a0052, #0b001a);
  box-shadow: inset 0 0 50px rgba(0,0,0,0.9);
}

/* ===== PLAYERS ===== */
.player {
  position: absolute;
  transform: translate(-50%, -50%);
  padding: 6px 14px;
  background: rgba(0,0,0,0.55);
  border-radius: 16px;
  font-size: 1.2rem;
}
.player.active {
  outline: 2px solid gold;
  box-shadow: 0 0 14px gold;
}

/* ===== CARD ===== */
#card {
  position: absolute;
  top: 50%;
  left: 50%;
  width: 160px;
  height: 230px;
  transform: translate(-50%, -50%);
  background: #fff;
  border-radius: 18px;
  box-shadow: 0 18px 40px rgba(0,0,0,0.7);
  display: flex;
  flex-direction: column;
  justify-content: space-between;
  padding: 14px;
  font-size: 2.4rem;
  color: black;
  transition: transform 0.6s;
}
#card.flip {
  transform: translate(-50%, -50%) rotateY(180deg);
}
.rank { font-weight: bold; }
.suit { font-size: 3.6rem; align-self: center; }
.red { color: #b11226; }

/* ===== RULE TEXT ===== */
#rule-text {
  font-size: 1.6rem;
  padding: 0 20px;
  min-height: 120px;
}

/* ===== DECK COUNT ===== */
#deck-count {
  font-size: 1.1rem;
  opacity: 0.8;
}
</style>
</head>

<body>

<button id="rules-toggle" onclick="toggleRules()">ğŸ“œ</button>

<div id="rules-panel">
  <div class="rule"><b>A</b> â€“ Countdown Waterfall</div>
  <div class="rule"><b>2</b> â€“ Pick someone</div>
  <div class="rule"><b>3</b> â€“ You drink</div>
  <div class="rule"><b>4</b> â€“ Silent Mode</div>
  <div class="rule"><b>5</b> â€“ Guys drink</div>
  <div class="rule"><b>6</b> â€“ Girls drink</div>
  <div class="rule"><b>7</b> â€“ Party Rule</div>
  <div class="rule"><b>8</b> â€“ Mate</div>
  <div class="rule"><b>9</b> â€“ Rhyme</div>
  <div class="rule"><b>10</b> â€“ Categories</div>
  <div class="rule"><b>J</b> â€“ Never Have I Ever</div>
  <div class="rule"><b>Q</b> â€“ Question Master</div>
  <div class="rule"><b>K</b> â€“ Kingâ€™s Cup</div>
</div>

<div id="setup">
  <h1>ğŸ† Kings of Cups</h1>
  <input id="player-input" placeholder="Player name">
  <br>
  <button onclick="addPlayer()">Add Player</button>
  <button onclick="startGame()">Start Game</button>
  <div id="player-list"></div>
</div>

<div id="game">
  <div id="active-rules"></div>

  <div id="table">
    <div id="card">
      <div class="rank">ğŸ†</div>
      <div class="suit">â™ </div>
      <div class="rank">ğŸ†</div>
    </div>
  </div>

  <div id="rule-text">Tap Deal Card</div>
  <button onclick="drawCard()">Deal Card</button>
  <div id="deck-count"></div>
</div>

<script>
function toggleRules() {
  document.getElementById("rules-panel").classList.toggle("open");
}

const suits = [
  { s: "â™ ", c: "black" },
  { s: "â™£", c: "black" },
  { s: "â™¥", c: "red" },
  { s: "â™¦", c: "red" }
];
const ranks = ["A","2","3","4","5","6","7","8","9","10","J","Q","K"];

const rules = {
  A: "ğŸ† Countdown Waterfall",
  2: "ğŸ‘‰ Pick someone to drink",
  3: "ğŸº You drink",
  4: "ğŸ¤« Silent Mode â€” No talking until next 4",
  5: "ğŸ‘¨ Guys drink",
  6: "ğŸ‘© Girls drink",
  7: "ğŸ‰ Party Rule â€” Make a rule",
  8: "ğŸ¤ Mate",
  9: "ğŸ¤ Rhyme",
  10: "ğŸ“š Categories",
  J: "ğŸ™ˆ Never Have I Ever",
  Q: "â“ Question Master",
  K: "ğŸ¥‚ Kingâ€™s Cup"
};

let deck = [];
let players = [];
let currentPlayer = 0;

let silentMode = null;
let partyRule = null;
let questionMaster = null;

/* ===== SETUP ===== */
function addPlayer() {
  const i = document.getElementById("player-input");
  if (!i.value.trim()) return;
  players.push(i.value.trim());
  i.value = "";
  document.getElementById("player-list").innerHTML = players.join("<br>");
}

function startGame() {
  if (players.length < 2) return alert("Add at least 2 players");
  document.getElementById("setup").style.display = "none";
  document.getElementById("game").style.display = "block";
  buildDeck();
  renderPlayers();
  updateDeckCount();
}

/* ===== DECK ===== */
function buildDeck() {
  deck = [];
  for (let r of ranks) for (let s of suits) deck.push({ rank: r, suit: s });
  deck.sort(() => Math.random() - 0.5);
}

/* ===== TABLE ===== */
function renderPlayers() {
  const table = document.getElementById("table");
  table.querySelectorAll(".player").forEach(p => p.remove());
  const r = 170;
  players.forEach((p, i) => {
    const a = (2 * Math.PI / players.length) * i;
    const el = document.createElement("div");
    el.className = "player" + (i === currentPlayer ? " active" : "");
    el.style.left = 210 + r * Math.cos(a) + "px";
    el.style.top = 210 + r * Math.sin(a) + "px";
    el.innerText = p;
    table.appendChild(el);
  });
}

/* ===== GAME ===== */
function drawCard() {
  if (!deck.length) buildDeck();
  const card = deck.pop();

  if (card.rank === "4") silentMode = silentMode ? null : players[currentPlayer];
  if (card.rank === "7") partyRule = partyRule ? null : players[currentPlayer];
  if (card.rank === "Q") questionMaster = players[currentPlayer];

  showCard(card);
  document.getElementById("rule-text").innerText = rules[card.rank];
  renderActiveRules();
  updateDeckCount();

  currentPlayer = (currentPlayer + 1) % players.length;
  renderPlayers();
}

function showCard(card) {
  const c = document.getElementById("card");
  c.classList.add("flip");
  setTimeout(() => {
    c.innerHTML = `
      <div class="rank ${card.suit.c}">${card.rank}</div>
      <div class="suit ${card.suit.c}">${card.suit.s}</div>
      <div class="rank ${card.suit.c}">${card.rank}</div>
    `;
  }, 300);
  setTimeout(() => c.classList.remove("flip"), 600);
}

function renderActiveRules() {
  const list = [];
  if (silentMode) list.push(`ğŸ¤« Silent Mode â€” ${silentMode}`);
  if (partyRule) list.push(`ğŸ‰ Party Rule â€” ${partyRule}`);
  if (questionMaster) list.push(`â“ Question Master â€” ${questionMaster}`);
  document.getElementById("active-rules").innerHTML =
    list.map(r => `<div class="active-rule">${r}</div>`).join("");
}

function updateDeckCount() {
  document.getElementById("deck-count").innerText =
    `Cards left: ${deck.length}/52`;
}
</script>

</body>
</html>
